<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- This file is automatically generated, do not edit -->

<HTML LANG='en'>
  <HEAD>
    <TITLE>11.3 Selections</TITLE>
    <LINK HREF='mailto:gilbert@ma2s2.mathematik.uni-karlsruhe.de' REV='made'>
    <LINK HREF='12_Events_and_Input.html' REL='Next'>
    <LINK HREF='11_2_Properties.html' REL='Previous'>
    <LINK HREF='index.html' REL='Start'>
    <LINK HREF='contents.html' REL='Contents'>
    <LINK HREF='the_index.html' REL='Index'>
    <LINK HREF='Glossary.html' REL='Glossary'>
    <LINK HREF='Front_matter.html' REL='Copyright'>
  <BODY BGCOLOR='#FFFFFF'>
    <A HREF='12_Events_and_Input.html'>Next</A> <A HREF='11_2_Properties.html'
    >Prev</A> <A HREF='11_Atoms__Properties_and_Selections.html'>Up</A> 
    <HR>
    <H1><FONT FACE='helvetica' COLOR='#004000'>11.3 Selections</FONT></H1>
     
    <P>
      A selection is an atom used to identify data that can be shared among 
      all client programs connected to an X server. Unlike properties, the 
      data represented by a selection is stored by some client program, not 
      by the server.
    <P>
      The data named by a selection is associated with a client window, which 
      is referred to as the <I>selection owner</I>. The server always knows 
      which window is the owner of a selection. Selections can be created 
      freely by clients using <A HREF='11_1_Atoms.html#intern-atom'><B>
      intern-atom</B></A> to create an atom. CLX provides functions to 
      inquire or change the owner of a selection and to <I>convert</I> a 
      selection.
    <P>
      Conversion is the key to the use of selections for inter-client 
      communication. Suppose Client A wants to paste the contents of the data 
      named by selection <I>S</I> into his window <I>WA</I>. Client A calls <A
       HREF='11_3_Selections.html#convert-selection'><B>convert-selection</B>
      </A> on selection atom <I>S</I>, sending a conversion request to the 
      server. The server, in turn, sends a <A
       HREF='12_12_7_Client_Communications_Events.html#:selection-request'><B>
      :selection-request</B></A> event to the current owner of <I>S</I>, 
      which is window <I>WB</I> belonging to Client B. The <A
       HREF='12_12_7_Client_Communications_Events.html#:selection-request'><B>
      :selection-request</B></A> event contains the <I>requestor</I> window (
      <I>WA</I>), the selection atom (<I>S</I>), an atom identifying a 
      requested data type, and the name of a property of <I>WA</I> into which 
      the value of <I>S</I> will be stored.
    <P>
      Since <I>WB</I> is the owner of <I>S</I>, it must be associated with 
      the data defined by Client B as the value of <I>S</I>. When <I>WB</I> 
      gets the <A
       HREF='12_12_7_Client_Communications_Events.html#:selection-request'><B>
      :selection-request</B></A> event, Client B is expected to convert the 
      value of <I>S</I> to the requested data type (if possible) and store 
      the converted value in the given requestor property. Client B is then 
      expected to send a <A
       HREF='12_12_7_Client_Communications_Events.html#:selection-notify'><B>
      :selection-notify</B></A> event to the requestor window <I>WA</I>, 
      informing the requestor that the converted value for <I>S</I> is ready. 
      Upon receiving the <A
       HREF='12_12_7_Client_Communications_Events.html#:selection-notify'><B>
      :selection-notify</B></A> event, Client A can call <A
       HREF='11_2_Properties.html#get-property'><B>get-property</B></A> to 
      retrieve the converted value and to paste it into <I>WA</I>.
    <P>
      <B>NOTE:</B> Clients using selections must always be prepared to handle 
      <A HREF='12_12_7_Client_Communications_Events.html#:selection-request'>
      <B>:selection-request</B></A> events and/or <A
       HREF='12_12_7_Client_Communications_Events.html#:selection-notify'><B>
      :selection-notify</B></A> events. There is no way for a client to ask 
      not to receive these types of events.
    <P>
      Type atoms used in selection conversion can represent arbitrary 
      client-defined interpretations of the selection data. For example, if 
      the value of selection <I>S</I> is a text string, Client A might 
      request its typeface by requesting conversion to the <B>:font</B> type. 
      A type <B>atom</B> can also represent a request to the selection owner 
      to perform some action as a side-effect of conversion (for example, <B>
      :delete</B>). Some of the predefined atoms of an X server are intended 
      to be used as selection types (for example, <B>:colormap</B>, <B>:bitmap
      </B>, <B>:string</B>, and so forth) However, X does not impose any 
      requirements on the interpretation of type atoms.
    <P>
      When multiple clients negotiate for ownership of a selection, certain 
      race conditions might be possible. For example, two clients might each 
      receive a user command to assert ownership of the <B>:primary</B> 
      selection, but the order in which the server processes these client 
      requests is unpredictable. As a result, the ownership request initiated 
      most recently by the user might be incorrectly overridden by the other 
      earlier ownership request. To prevent such anomalies, the server 
      records a <I>last-changed</I> timestamp for each change of selection 
      ownership.
    <P>
      Although inter-client communication via selections is rather complex, 
      it offers important benefits. Since selection communication is mediated 
      by an X server, clients can share data even though they are running on 
      different hosts and using different networking protocols. Data storage 
      and conversion is distributed among clients so that the server is not 
      required to provide all possible data types or to store multiple forms 
      of selection data.
    <P>
      Certain predefined atoms are used as standard selections, as described 
      in the X11 Inter-client Communications Conventions Manual. Some of the 
      standard selections covered by these conventions are:
    <DL>
      <DT>
        <B>:primary</B>
      <DD>
        The <I>primary selection</I>. The main vehicle for inter-client cut 
        and paste operations.
      <DT>
        <B>:secondary</B>
      <DD>
        The <I>secondary selection</I>. In some environments, clients can use 
        this as an auxiliary to <B>:primary</B>.
      <DT>
        <B>:clipboard</B>
      <DD>
        Analogous to akill ring. Represents the most recently deleted data 
        item.
    </DL>
     
    <DIV>
      <HR>
      <A NAME='convert-selection'></A>
      <TABLE>
        <TR>
          <TD VALIGN='TOP' ALIGN='LEFT'><B>convert-selection</B>
          <TD WIDTH='100%' VALIGN='TOP' ALIGN='LEFT'><I>selection type 
            requestor</I> &#38;optional <I>property time</I>
          <TD VALIGN='TOP' ALIGN='RIGHT'>Function
      </TABLE>
      <TABLE>
        <TR>
          <TD>&#160;&#160;&#160;&#160;&#160;
          <TD>
            <DL>
              <DT>
                <I>selection</I>
              <DD>
                The <A HREF='1_6_Data_Types.html#xatom'><B>xatom</B></A> for 
                the selection name.
              <DT>
                <I>type</I>
              <DD>
                The <A HREF='1_6_Data_Types.html#xatom'><B>xatom</B></A> for 
                the requested data type.
              <DT>
                <I>requestor</I>
              <DD>
                The <A HREF='1_6_Data_Types.html#window'><B>window</B></A> to 
                receive the converted <I>selection</I> value.
              <DT>
                <I>property</I>
              <DD>
                The <A HREF='1_6_Data_Types.html#xatom'><B>xatom</B></A> for 
                the requestor property to receive the converted value.
              <DT>
                <I>time</I>
              <DD>
                A <A HREF='1_6_Data_Types.html#timestamp'><B>timestamp</B></A>
                .
            </DL>
            <P>
              Requests that the value of the <I>selection</I> be converted to 
              the specified <I>type</I> and stored in the given <I>property
              </I> of the <I>requestor</I> window.
            <P>
              If the <I>selection</I> has an owner, the X server sends a <A
               HREF='12_12_7_Client_Communications_Events.html#:selection-request'
              ><B>:selection-request</B></A> event to the owner window. 
              Otherwise, if no owner exists, the server generates on the 
              requestor a <A
               HREF='12_12_7_Client_Communications_Events.html#:selection-notify'
              ><B>:selection-notify</B></A> event containing a <B>nil</B> <I>
              property</I> atom.
            <P>
              The given <I>property</I> specifies the requestor property that 
              will receive the converted value. If the <I>property</I> is 
              omitted, the <I>selection</I> owner will define a property to 
              use. The <I>time</I> furnishes a timestamp representing the 
              time of the conversion request; by default, the current server 
              time is used.
            <P>
              <B>NOTE:</B> Standard conventions for inter-client 
              communication require that both the requestor property and the 
              time must be specified. If possible, the time should be the 
              time of a user event which initiated the conversion. 
              Alternatively, a timestamp can be obtained by calling <A
               HREF='11_2_Properties.html#change-property'><B>change-property
              </B></A> to append zero-length data to some property; the 
              timestamp in the resulting <A
               HREF='12_12_7_Client_Communications_Events.html#:property-notify'
              ><B>:property-notify</B></A> event can then be used.
      </TABLE>
    </DIV>
     
    <DIV>
      <HR>
      <A NAME='selection-owner'></A>
      <TABLE>
        <TR>
          <TD VALIGN='TOP' ALIGN='LEFT'><B>selection-owner</B>
          <TD WIDTH='100%' VALIGN='TOP' ALIGN='LEFT'><I>display selection</I> 
            &#38;optional <I>time</I>
          <TD VALIGN='TOP' ALIGN='RIGHT'>Function
      </TABLE>
      <TABLE>
        <TR>
          <TD>&#160;&#160;&#160;&#160;&#160;
          <TD>
            <DL>
              <DT>
                <I>display</I>
              <DD>
                A <A HREF='1_6_Data_Types.html#display'><B>display</B></A>.
              <DT>
                <I>selection</I>
              <DD>
                The <A HREF='1_6_Data_Types.html#xatom'><B>xatom</B></A> for 
                the selection name.
              <DT>
                <I>time</I>
              <DD>
                A <A HREF='1_6_Data_Types.html#timestamp'><B>timestamp</B></A>
                .
            </DL>
            <P>
              Returns and (with <B>setf</B>) changes the owner and the 
              last-changed <I>time</I> for the <I>selection</I>. If the owner 
              is <B>nil</B>, no owner for the <I>selection</I> exists. When 
              the owner window for a <I>selection</I> is destroyed, the <I>
              selection</I> owner is set to <B>nil</B> without affecting the 
              last-changed <I>time</I>.
            <P>
              The <I>time</I> argument is used only when changing the <I>
              selection</I> owner. If the <I>time</I> is <B>nil</B>, the 
              current server time is used. If the <I>time</I> is earlier than 
              the current last-changed time of the <I>selection</I> or if the 
              <I>time</I> is later than the current server time, the owner is 
              not changed. Therefore, a client should always confirm 
              successful change of ownership by immediately calling <A
               HREF='11_3_Selections.html#selection-owner'><B>selection-owner
              </B></A>. If the change in ownership is successful, the 
              last-changed time of the <I>selection</I> is set to the 
              specified <I>time</I>.
            <P>
              If the change in ownership is successful and the new owner is 
              different from the previous owner, and if the previous owner is 
              not <B>nil</B>, a <A
               HREF='12_12_7_Client_Communications_Events.html#:selection-clear'
              ><B>:selection-clear</B></A> event is generated for the 
              previous owner window.
            <P>
              <B>NOTE:</B> Standard conventions for inter-client 
              communication require that a non-nil time must be specified. If 
              possible, the time should be the time of a user event which 
              initiated the change of ownership. Alternatively, a timestamp 
              can be obtained by calling change-property to append 
              zero-length data to some property; the timestamp in the 
              resulting <A
               HREF='12_12_7_Client_Communications_Events.html#:property-notify'
              ><B>:property-notify</B></A> event can then be used.
            <DL>
              <DT>
                <I>owner</I>
              <DD>
                Type <A HREF='1_6_Data_Types.html#window'><B>window</B></A> 
                or <B>null</B>.
            </DL>
      </TABLE>
    </DIV>
     
    <HR>
    <A HREF='12_Events_and_Input.html'>Next</A> <A HREF='11_2_Properties.html'
    >Prev</A> <A HREF='11_Atoms__Properties_and_Selections.html'>Up</A> 
    <HR>
    <A HREF='Front_matter.html'>&#169; 1988, 1989 Texas Instruments 
    Incorporated</A>
    <BR>
    Conversion to HTML made by <A
     HREF='mailto:gilbert@ma2s2.mathematik.uni-karlsruhe.de' LANG='de'>
    Gilbert Baumann</A>.
    <BR>
    Last build: Tue Dec 16 23:30:42 1997
