<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- This file is automatically generated, do not edit -->

<HTML LANG='en'>
  <HEAD>
    <TITLE>14.5 Client Termination</TITLE>
    <LINK HREF='mailto:gilbert@ma2s2.mathematik.uni-karlsruhe.de' REV='made'>
    <LINK HREF='14_6_Managing_Host_Access.html' REL='Next'>
    <LINK HREF='14_4_3_Using_Keycodes_and_Keysyms.html' REL='Previous'>
    <LINK HREF='index.html' REL='Start'>
    <LINK HREF='contents.html' REL='Contents'>
    <LINK HREF='the_index.html' REL='Index'>
    <LINK HREF='Glossary.html' REL='Glossary'>
    <LINK HREF='Front_matter.html' REL='Copyright'>
  <BODY BGCOLOR='#FFFFFF'>
    <A HREF='14_6_Managing_Host_Access.html'>Next</A> <A
     HREF='14_4_3_Using_Keycodes_and_Keysyms.html'>Prev</A> <A
     HREF='14_Control_Functions.html'>Up</A> 
    <HR>
    <H1><FONT FACE='helvetica' COLOR='#004000'>14.5 Client Termination</FONT>
    </H1>
     
    <P>
      The CLX functions affecting client termination are discussed in the 
      following paragraphs.
    <P>
      When a display connection to an X server is closed, whether by an 
      explicit call to <A HREF='2_5_Closing_the_Display.html#close-display'><B
      >close-display</B></A> or by some external condition, the server 
      automatically performs a sequence of operations to clean up server 
      state information associated with the closed connection. The effect of 
      these operations depends the <I>close-down mode</I> and the <I>save-set
      </I> that the client has specified for the closed display connection. 
      The close-down mode of a display determines whether server resources 
      allocated by the connection are freed or not. The save-set identifies 
      windows that will remain after the connection is closed.
    <P>
      The display save-set is used primarily by window managers that reparent 
      the top-level windows of other clients. For example, such a window 
      manager can automatically create a frame window that encloses a 
      top-level client window, along with a set of controls used for window 
      management. Ordinarily, termination of the window manager client would 
      then destroy all client windows! However, the window manager can 
      prevent this by adding to its save-set those windows created by other 
      clients that should be preserved.
    <P>
      When a display connection closes, an X server performs the following 
      operations:
    <OL>
      <LI>
        For each selection owned by a window created on the connection, the 
        selection owner is set to <B>nil</B>.
      <LI>
        An active or passive grab established for a window created on the 
        connection is released.
      <LI>
        If the connection has grabbed the server, the server is ungrabbed.
      <LI>
        Server resources and colormap cells allocated by the connection are 
        freed and destroyed, depending on the close-down mode, as follows: 
        <UL>
          <LI>
            <B>:retain-permanent</B> -- All resources are marked <I>permanent
            </I>, and no resources are destroyed. These resources can later 
            be destroyed by a call to <A
             HREF='14_5_Client_Termination.html#kill-client'><B>kill-client
            </B></A>.
          <LI>
            <B>:retain-temporary</B> -- All resources are marked <I>temporary
            </I>, and no resources are destroyed. These resources can later 
            be destroyed by a call to <A
             HREF='14_5_Client_Termination.html#kill-client'><B>kill-client
            </B></A> or <A
             HREF='14_5_Client_Termination.html#kill-temporary-clients'><B>
            kill-temporary-clients</B></A>.
          <LI>
            <B>:destroy</B> -- All resources are destroyed.
        </UL>
    </OL>
     
    <P>
      When server resources allocated by a display connection are destroyed 
      -- whether by closing the connection with close-down mode <B>:destroy
      </B> or by later calling <A
       HREF='14_5_Client_Termination.html#kill-client'><B>kill-client</B></A> 
      or <A HREF='14_5_Client_Termination.html#kill-temporary-clients'><B>
      kill-temporary-clients</B></A> -- then an X server performs the 
      following operations on each member of the save-set before actually 
      destroying resources.
    <OL>
      <LI>
        If the save-set window is a descendant of a window created on the 
        connection, the save-set window is reparented. The new parent is the 
        closest ancestor such that the save-set window is no longer a 
        descendant of any window created on the connection. The position of 
        the reparented window with respect to its parent remains unchanged.
      <LI>
        If the save-set window is unmapped, then it is mapped.
    </OL>
     
    <P>
      If the last connection open to an X server is closed with close-down 
      mode <B>:destroy</B>, the server resets its state to restore all 
      initial defaults. The server state after reset is the same as its 
      initial state when first started. When an X server resets, it performs 
      the following operations:
    <UL>
      <LI>
        All permanent and temporary server resources from previously-closed 
        connections are destroyed.
      <LI>
        All but the predefined atoms are deleted.
      <LI>
        All root window properties are deleted.
      <LI>
        All device control attributes and mappings are restored to their 
        original default values.
      <LI>
        The default background and cursor for all root windows are restored.
      <LI>
        The default font path is restored.
      <LI>
        The input focus is set to <B>:pointer-root</B>.
      <LI>
        The access control list is reset.
    </UL>
     
    <P>
      The following paragraphs describe the CLX functions used to:
    <UL>
      <LI>
        Add or remove a window from a display save-set.
      <LI>
        Return or change the display close-down mode.
      <LI>
        Force a connection to be closed or all its server resources to be 
        destroyed.
      <LI>
        Force a connection to be closed and all temporary resources to be 
        destroyed.
    </UL>
     
    <DIV>
      <HR>
      <A NAME='add-to-save-set'></A>
      <TABLE>
        <TR>
          <TD VALIGN='TOP' ALIGN='LEFT'><B>add-to-save-set</B>
          <TD WIDTH='100%' VALIGN='TOP' ALIGN='LEFT'><I>window</I>
          <TD VALIGN='TOP' ALIGN='RIGHT'>Function
      </TABLE>
      <TABLE>
        <TR>
          <TD>&#160;&#160;&#160;&#160;&#160;
          <TD>
            <DL>
              <DT>
                <I>window</I>
              <DD>
                A <A HREF='1_6_Data_Types.html#window'><B>window</B></A>.
            </DL>
            <P>
              Adds the specified <I>window</I> to the save-set of the <I>
              window</I> display. The <I>window</I> must have been created by 
              some other display. Windows are removed automatically from the 
              save-set when they are destroyed.
      </TABLE>
    </DIV>
     
    <DIV>
      <HR>
      <A NAME='close-down-mode'></A>
      <TABLE>
        <TR>
          <TD VALIGN='TOP' ALIGN='LEFT'><B>close-down-mode</B>
          <TD WIDTH='100%' VALIGN='TOP' ALIGN='LEFT'><I>display</I>
          <TD VALIGN='TOP' ALIGN='RIGHT'>Function
      </TABLE>
      <TABLE>
        <TR>
          <TD>&#160;&#160;&#160;&#160;&#160;
          <TD>
            <DL>
              <DT>
                <I>display</I>
              <DD>
                A <A HREF='1_6_Data_Types.html#display'><B>display</B></A>.
            </DL>
            <P>
              Returns and (with <B>setf</B>) sets the close-down mode of the 
              client&#39;s resources at connection close.
            <DL>
              <DT>
                <I>mode</I>
              <DD>
                One of <B>:destroy</B>, <B>:retain-permanent</B>, or <B>
                :retain-temporary</B>.
            </DL>
      </TABLE>
    </DIV>
     
    <DIV>
      <HR>
      <A NAME='kill-client'></A>
      <TABLE>
        <TR>
          <TD VALIGN='TOP' ALIGN='LEFT'><B>kill-client</B>
          <TD WIDTH='100%' VALIGN='TOP' ALIGN='LEFT'><I>display resource-id
            </I>
          <TD VALIGN='TOP' ALIGN='RIGHT'>Function
      </TABLE>
      <TABLE>
        <TR>
          <TD>&#160;&#160;&#160;&#160;&#160;
          <TD>
            <DL>
              <DT>
                <I>display</I>
              <DD>
                A <A HREF='1_6_Data_Types.html#display'><B>display</B></A>.
              <DT>
                <I>resource-id</I>
              <DD>
                A valid <A HREF='1_6_Data_Types.html#card29'><B>card29</B></A>
                 resource ID.
            </DL>
            <P>
              Closes the display connection which created the given <I>
              resource-id</I>. The <I>resource-id</I> must be valid, but need 
              not belong to the given <I>display</I>.
            <P>
              If the closed connection was previously open, the connection is 
              closed according to its close-down mode. Otherwise, if the 
              connection had been previously terminated with close-down mode 
              <B>:retain-permanent</B> or <B>:retain-temporary</B>, then all 
              its retained server resources -- both permanent and temporary 
              -- are destroyed.
      </TABLE>
    </DIV>
     
    <DIV>
      <HR>
      <A NAME='kill-temporary-clients'></A>
      <TABLE>
        <TR>
          <TD VALIGN='TOP' ALIGN='LEFT'><B>kill-temporary-clients</B>
          <TD WIDTH='100%' VALIGN='TOP' ALIGN='LEFT'><I>display</I>
          <TD VALIGN='TOP' ALIGN='RIGHT'>Function
      </TABLE>
      <TABLE>
        <TR>
          <TD>&#160;&#160;&#160;&#160;&#160;
          <TD>
            <DL>
              <DT>
                <I>display</I>
              <DD>
                A <A HREF='1_6_Data_Types.html#display'><B>display</B></A>.
            </DL>
            <P>
              Closes the <I>display</I> connection and destroys all retained 
              temporary server resources for this and all 
              previously-terminated connections.
            <P>
              If the <I>display</I> connection was previously open, the 
              connection is closed according to its close-down mode. 
              Otherwise, if the <I>display</I> connection had been previously 
              terminated with close-down mode <B>:retain-permanent</B> or <B>
              :retain-temporary</B>, then all its retained server resources 
              -- both permanent and temporary -- are destroyed.
      </TABLE>
    </DIV>
     
    <DIV>
      <HR>
      <A NAME='remove-from-save-set'></A>
      <TABLE>
        <TR>
          <TD VALIGN='TOP' ALIGN='LEFT'><B>remove-from-save-set</B>
          <TD WIDTH='100%' VALIGN='TOP' ALIGN='LEFT'><I>window</I>
          <TD VALIGN='TOP' ALIGN='RIGHT'>Function
      </TABLE>
      <TABLE>
        <TR>
          <TD>&#160;&#160;&#160;&#160;&#160;
          <TD>
            <DL>
              <DT>
                <I>window</I>
              <DD>
                A <A HREF='1_6_Data_Types.html#window'><B>window</B></A>.
            </DL>
            <P>
              Removes the specified <I>window</I> from the save-set of the <I>
              window</I> display. The <I>window</I> must have been created by 
              some other display. Windows are removed automatically from the 
              save-set when they are destroyed.
      </TABLE>
    </DIV>
     
    <HR>
    <A HREF='14_6_Managing_Host_Access.html'>Next</A> <A
     HREF='14_4_3_Using_Keycodes_and_Keysyms.html'>Prev</A> <A
     HREF='14_Control_Functions.html'>Up</A> 
    <HR>
    <A HREF='Front_matter.html'>&#169; 1988, 1989 Texas Instruments 
    Incorporated</A>
    <BR>
    Conversion to HTML made by <A
     HREF='mailto:gilbert@ma2s2.mathematik.uni-karlsruhe.de' LANG='de'>
    Gilbert Baumann</A>.
    <BR>
    Last build: Tue Dec 16 23:30:42 1997
